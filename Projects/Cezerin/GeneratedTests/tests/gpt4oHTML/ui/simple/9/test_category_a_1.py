import unittest
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from webdriver_manager.chrome import ChromeDriverManager

class UITestCase(unittest.TestCase):

    def setUp(self):
        self.driver = webdriver.Chrome(ChromeDriverManager().install())
        self.driver.get("data:text/html;charset=utf-8,{0}".format(html_data["html"]))

    def tearDown(self):
        self.driver.quit()

    def test_ui_components(self):
        driver = self.driver

        # Check that the header is present and visible
        try:
            WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.TAG_NAME, "header"))
            )
        except:
            self.fail("Header element is missing or not visible")

        # Check for the logo link in the header
        try:
            logo_link = WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.CSS_SELECTOR, ".logo-image.active"))
            )
            self.assertEqual(logo_link.get_attribute("href"), "/")
        except:
            self.fail("Logo link is missing or not visible")

        # Check for the search input in the header
        try:
            search_input = WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.CSS_SELECTOR, ".search-input"))
            )
            self.assertEqual(search_input.get_attribute("placeholder"), "Search")
        except:
            self.fail("Search input is missing or not visible")

        # Check for navigation links
        try:
            nav_links = WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.CSS_SELECTOR, ".primary-nav.is-hidden-mobile"))
            )
            self.assertIsNotNone(nav_links)
        except:
            self.fail("Navigation links are missing or not visible")

        # Check for the breadcrumb links
        try:
            breadcrumb_nav = WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.CSS_SELECTOR, ".breadcrumb"))
            )
            self.assertIsNotNone(breadcrumb_nav)
        except:
            self.fail("Breadcrumb navigation is missing or not visible")

        # Check for form fields (sort dropdown)
        try:
            sort_dropdown = WebDriverWait(driver, 20).until(
                EC.visibility_of_element_located((By.CSS_SELECTOR, "select"))
            )
            self.assertIsNotNone(sort_dropdown)
        except:
            self.fail("Sort dropdown is missing or not visible")

        # Check that add to cart script text is injected
        try:
            self.assertIn("Add to cart", driver.page_source)
        except:
            self.fail("'Add to cart' script text is missing")

# Define the HTML data input for testing.
html_data = {
    "html": "<html lang=\"en\"><head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n  <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n  <meta name=\"theme-color\" content=\"#f5f5f5\">\n  <title>Subcategory 1</title>\n  <meta data-react-helmet=\"true\" property=\"og:url\" content=\"/category-a-1\"><meta data-react-helmet=\"true\" property=\"og:type\" content=\"product.group\"><meta data-react-helmet=\"true\" property=\"og:title\" content=\"Subcategory 1\">\n  \n  <link data-react-helmet=\"true\" rel=\"canonical\" href=\"/category-a-1\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/icons/icon-16.png\" sizes=\"16x16\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/icons/icon-32.png\" sizes=\"32x32\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/icons/icon-128.png\" sizes=\"128x128\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/icons/icon-256.png\" sizes=\"256x256\">\n  <link rel=\"icon\" type=\"image/png\" href=\"/assets/images/icons/icon-512.png\" sizes=\"512x512\">\n  <link rel=\"manifest\" href=\"/assets/manifest.json\">\n  <link href=\"https://googleads.g.doubleclick.net\" rel=\"preconnect\">\n  <link href=\"https://stats.g.doubleclick.net\" rel=\"preconnect\">\n  <link href=\"https://www.google-analytics.com\" rel=\"preconnect\">\n  <link href=\"https://www.googleadservices.com\" rel=\"preconnect\">\n  <link href=\"https://www.googletagmanager.com\" rel=\"preconnect\">\n  \n  \n<link href=\"/assets/css/bundle-f5fdf2e7341cd05cfac9.css\" rel=\"stylesheet\"><link href=\"/assets/css/bundle-f5fdf2e7341cd05cfac9.css\" rel=\"stylesheet\"><link href=\"/assets/css/bundle-f5fdf2e7341cd05cfac9.css\" rel=\"stylesheet\"></head>\n<body style=\"margin-top: 131px; zoom: 50%;\">\n  \n\n  <div id=\"app\"><header class=\"\"><div class=\"container\"><div class=\"columns is-gapless is-mobile header-container\"><div class=\"column is-4\"><span class=\"navbar-burger is-hidden-tablet\"><span></span><span></span><span></span></span></div><div class=\"column is-4 has-text-centered\"><a class=\"logo-image active\" aria-current=\"page\" href=\"/\"><img alt=\"logo\"></a></div><div class=\"column is-4 has-text-right header-block-right\"><span class=\"icon icon-search is-hidden-tablet\"><img src=\"/assets/images/search.svg\" alt=\"Search\" title=\"Search\" style=\"min-width:24px\"></span><div class=\"search-box \"><input type=\"text\" class=\"search-input\" placeholder=\"Search\" value=\"\"><img class=\"search-icon-search\" src=\"/assets/images/search.svg\" alt=\"Search\" title=\"Search\"></div><span class=\"cart-button\"><img src=\"/assets/images/shopping-bag.svg\" class=\"icon\" alt=\"cart\" title=\"cart\" style=\"min-width:24px\"></span><div class=\"\"><div class=\"mini-cart\"><p>Your cart is empty</p></div></div></div></div><div class=\"primary-nav is-hidden-mobile\"><ul class=\"nav-level-0\"><li class=\" has-items\"><div class=\"cat-parent\"><a class=\"has-items\" href=\"/category-a\">Category A</a></div><ul class=\"columns is-gapless is-multiline nav-level-1\"><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"is-active\" aria-current=\"page\" href=\"/category-a-1\">Subcategory 1</a></div></li><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-a-2\">Subcategory 2</a></div></li><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-a-3\">Subcategory 3</a></div></li></ul></li><li class=\"\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-b\">Category B</a></div></li><li class=\"\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-c\">Category C</a></div></li></ul></div></div></header><div class=\"\"></div><div class=\"mobile-nav is-hidden-tablet\"><ul class=\"nav-level-0\"><li class=\" has-items\"><div class=\"cat-parent\"><a class=\"has-items\" href=\"/category-a\">Category A</a><span></span></div><ul class=\"columns is-gapless is-multiline nav-level-1\"><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"is-active\" aria-current=\"page\" href=\"/category-a-1\">Subcategory 1</a></div></li><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-a-2\">Subcategory 2</a></div></li><li class=\"column is-3\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-a-3\">Subcategory 3</a></div></li></ul></li><li class=\"\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-b\">Category B</a></div></li><li class=\"\"><div class=\"cat-parent\"><a class=\"\" href=\"/category-c\">Category C</a></div></li></ul></div><section class=\"hero is-light\"><div class=\"hero-body\"><div class=\"container\"><nav class=\"breadcrumb is-small\" aria-label=\"breadcrumbs\"><ul><li><a class=\"active\" aria-current=\"page\" href=\"/\">Home</a></li><li><a href=\"/category-a\">Category A</a></li><li class=\"is-active\"><a href=\"/category-a-1\" aria-current=\"page\">Subcategory 1</a></li></ul></nav><h1 class=\"category-title\">Subcategory 1</h1><div class=\"category-description is-hidden-mobile content\"></div></div></div></section><section class=\"section section-category\"><div class=\"container\"><div class=\"columns\"><div class=\"column is-one-quarter left-sidebar\"><div><div class=\"is-hidden-tablet\"><button class=\"button is-fullwidth\">Filter products</button></div><div class=\"is-hidden-mobile\" style=\"z-index:101\"><div class=\"\"></div><div class=\"\"><div class=\"\"><div class=\"is-hidden-tablet\" style=\"margin-bottom:30px\"><div class=\"columns is-mobile sort\"><div class=\"column is-4 sort-title\">Sort<!-- -->:</div><div class=\"column\"><span class=\"select is-fullwidth\"><select><option selected=\"\" value=\"stock_status,price,position\">Favorite</option><option value=\"-date_created\">Newest</option><option value=\"price\">Price low to high</option><option value=\"-price\">Price high to low</option></select></span></div></div></div><div class=\"attribute-filter\"></div><div class=\"price-filter\"><div class=\"attribute-title\">Price</div><div class=\"rc-slider rc-slider-disabled price-filter-range\"><div class=\"rc-slider-rail\"></div><div class=\"rc-slider-track rc-slider-track-1\" style=\"left:NaN%;right:auto;width:NaN%\"></div><div class=\"rc-slider-step\"></div><div class=\"rc-slider-handle rc-slider-handle-1\" style=\"left:NaN%;right:auto;transform:translateX(-50%)\" role=\"slider\" aria-valuemin=\"0\" aria-valuemax=\"0\" aria-valuenow=\"0\" aria-disabled=\"true\"></div><div class=\"rc-slider-handle rc-slider-handle-2\" style=\"left:NaN%;right:auto;transform:translateX(-50%)\" role=\"slider\" aria-valuemin=\"0\" aria-valuemax=\"0\" aria-valuenow=\"0\" aria-disabled=\"true\"></div><div class=\"rc-slider-mark\"></div></div><div class=\"columns is-mobile is-gapless price-filter-values\"><div class=\"column has-text-left\">$0.00</div><div class=\"column has-text-right\">$0.00</div></div></div><button class=\"button is-fullwidth is-dark is-hidden-tablet\">Close</button></div></div></div></div></div><div class=\"column\"><div class=\"columns is-hidden-mobile\"><div class=\"column\"></div><div class=\"column is-5\"><div class=\"columns is-mobile sort\"><div class=\"column is-4 sort-title\">Sort<!-- -->:</div><div class=\"column\"><span class=\"select is-fullwidth\"><select><option selected=\"\" value=\"stock_status,price,position\">Favorite</option><option value=\"-date_created\">Newest</option><option value=\"price\">Price low to high</option><option value=\"-price\">Price high to low</option></select></span></div></div></div></div><div class=\"columns is-multiline is-mobile products\"></div><div class=\"load-more\"></div></div></div></div></section><section class=\"section section-footer\"><hr><footer><div class=\"container\"><div class=\"content\"><div class=\"columns is-gapless\"><div class=\"column is-5\"><div class=\"mobile-padding\"><div class=\"footer-logo\"><img src=\"/assets/images/logo.png\" alt=\"logo\"></div><p><small>Store - just to show you what it can. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here.</small></p><ul class=\"footer-contacts\"><li>104 N Stagecoach Rd</li><li>Dover Foxcroft, ME, 04426</li><li>(207) 564-8482</li><li><a href=\"mailto:sales@shop.com\">sales@shop.com</a></li></ul><p class=\"social-icons\"><a href=\"https://www.facebook.com/\" target=\"_blank\" rel=\"noopener\" title=\"facebook\" class=\"facebook\"></a><a href=\"https://twitter.com/\" target=\"_blank\" rel=\"noopener\" title=\"twitter\" class=\"twitter\"></a></p></div></div><div class=\"column is-1 is-hidden-mobile\"></div><div class=\"column is-3\"><div class=\"footer-title mobile-padding\">Company<span></span></div><ul class=\"footer-menu\"><li><a href=\"/about\">About</a></li><li><a href=\"/blog\">Blog</a></li><li><a href=\"/tos\">Terms of Service</a></li><li><a href=\"/privacy-policy\">Privacy Policy</a></li></ul></div><div class=\"column is-3\"><div class=\"footer-title mobile-padding\">Customer service<span></span></div><ul class=\"footer-menu\"><li><a class=\"active\" aria-current=\"page\" href=\"/\">Shipping &amp; returns</a></li><li><a class=\"active\" aria-current=\"page\" href=\"/\">Conditions of Use</a></li><li><a class=\"active\" aria-current=\"page\" href=\"/\">Sitemap</a></li></ul></div></div></div></div></footer></section></div>\n\n  <script>\n    function resizeElements() {\n      if(window.innerWidth >= 769){\n        var allHeaders = document.getElementsByTagName('header');\n        var header = allHeaders && allHeaders.length > 0 ? allHeaders[0] : null;\n\n        if (header) {\n          document.getElementsByTagName(\"body\")[0].style.marginTop = header.clientHeight + \"px\";\n        }\n      }\n    }\n    resizeElements();\n    window.addEventListener('resize', resizeElements);\n    window.addEventListener('load', resizeElements);\n  </script>\n\n  <script charset=\"UTF-8\">\n    window.__APP_TEXT__ = {\"addToCart\":\"Add to cart\",\"cart\":\"cart\",\"cartEmpty\":\"Your cart is empty\",\"proceedToCheckout\":\"Go to checkout\",\"subtotal\":\"Subtotal\",\"shipping\":\"Shipping\",\"discount\":\"Discount\",\"total\":\"Total\",\"remove\":\"Remove\",\"qty\":\"Qty\",\"price\":\"Price\",\"checkoutPageTitle\":\"Checkout\",\"grandTotal\":\"Grand total\",\"orderSummary\":\"Order Summary\",\"checkoutSuccessTitle\":\"Thanks for your order!\",\"outOfStock\":\"Out of stock\",\"inStock\":\"In Stock\",\"discontinued\":\"Discontinued\",\"relatedProducts\":\"You May Also Like\",\"filterProducts\":\"Filter products\",\"sort\":\"Sort\",\"sortFavorite\":\"Favorite\",\"sortNewest\":\"Newest\",\"sortPriceLow\":\"Price low to high\",\"sortPriceHigh\":\"Price high to low\",\"title404\":\"Page not found\",\"loadMore\":\"Show more products\",\"text404\":\"The page you requested does not exist. Click here to continue shopping.\",\"search\":\"Search\",\"searchPlaceholder\":\"Search\",\"resultsFor\":\"Results for\",\"selectOption\":\"Select\",\"optionsRequired\":\"You need to choose options\",\"shippingAddress\":\"Shipping Address\",\"billingAddress\":\"Billing Address\",\"shippingMethod\":\"Shipping method\",\"paymentMethod\":\"Payment method\",\"orderNumber\":\"Order number\",\"productName\":\"Product\",\"close\":\"Close\",\"attributes\":\"Product details\",\"home\":\"Home\",\"saleEnds\":\"Offer ends\",\"days\":\"days\",\"hours\":\"hrs\",\"minutes\":\"mins\",\"seconds\":\"secs\",\"email\":\"Email\",\"mobile\":\"Mobile\",\"country\":\"Country\",\"state\":\"State/Province\",\"city\":\"City\",\"fullName\":\"Full name\",\"address1\":\"Address line 1\",\"address2\":\"Address line 2\",\"postal_code\":\"Postal code\",\"phone\":\"Phone\",\"company\":\"Company\",\"comments\":\"Comments\",\"recentlyViewed\":\"Recently Viewed\",\"loading\":\"Loading...\",\"optional\":\"optional\",\"shippingTo\":\"Shipping To\",\"shippingMethods\":\"Shipping options\",\"paymentMethods\":\"Payment options\",\"orderSubmit\":\"Place Order\",\"emptyCheckout\":\"Your cart is empty\",\"required\":\"This field is required.\",\"emailInvalid\":\"Please enter a valid email address.\",\"sameAsShipping\":\"Same as shipping address\",\"edit\":\"Edit\",\"next\":\"Next\",\"customerDetails\":\"Customer Details\",\"payment\":\"Payment\"};\n    window.__APP_STATE__ = {\"app\":{\"settings\":{\"domain\":\"\",\"logo_file\":null,\"language\":\"en\",\"currency_code\":\"USD\",\"currency_symbol\":\"$\",\"currency_format\":\"${amount}\",\"thousand_separator\":\",\",\"decimal_separator\":\".\",\"decimal_number\":2,\"timezone\":\"Asia/Singapore\",\"date_format\":\"MMMM D, YYYY\",\"time_format\":\"h:mm a\",\"default_shipping_country\":\"SG\",\"default_shipping_state\":\"\",\"default_shipping_city\":\"\",\"default_product_sorting\":\"stock_status,price,position\",\"product_fields\":\"path,id,name,category_id,category_name,sku,images,enabled,discontinued,stock_status,stock_quantity,price,on_sale,regular_price,attributes,tags,position\",\"products_limit\":30,\"weight_unit\":\"kg\",\"length_unit\":\"cm\",\"hide_billing_address\":false,\"order_confirmation_copy_to\":\"\",\"logo\":null},\"location\":{\"hasHistory\":false,\"pathname\":\"/category-a-1\",\"search\":\"\",\"hash\":\"\"},\"currentPage\":{\"path\":\"/category-a-1\",\"type\":\"product-category\",\"resource\":\"67ca982ef38a654a7c2c1a63\"},\"pageDetails\":{},\"categoryDetails\":{\"name\":\"Subcategory 1\",\"slug\":\"category-a-1\",\"image\":\"\",\"parent_id\":\"67ca982ef38a654a7c2c1a60\",\"id\":\"67ca982ef38a654a7c2c1a63\",\"url\":\"/category-a-1\",\"path\":\"/category-a-1\"},\"productDetails\":{},\"categories\":[{\"name\":\"Category A\",\"slug\":\"category-a\",\"image\":\"\",\"parent_id\":null,\"id\":\"67ca982ef38a654a7c2c1a60\",\"url\":\"/category-a\",\"path\":\"/category-a\"},{\"name\":\"Category B\",\"slug\":\"category-b\",\"image\":\"\",\"parent_id\":null,\"id\":\"67ca982ef38a654a7c2c1a61\",\"url\":\"/category-b\",\"path\":\"/category-b\"},{\"name\":\"Category C\",\"slug\":\"category-c\",\"image\":\"\",\"parent_id\":null,\"id\":\"67ca982ef38a654a7c2c1a62\",\"url\":\"/category-c\",\"path\":\"/category-c\"},{\"name\":\"Subcategory 1\",\"slug\":\"category-a-1\",\"image\":\"\",\"parent_id\":\"67ca982ef38a654a7c2c1a60\",\"id\":\"67ca982ef38a654a7c2c1a63\",\"url\":\"/category-a-1\",\"path\":\"/category-a-1\"},{\"name\":\"Subcategory 2\",\"slug\":\"category-a-2\",\"image\":\"\",\"parent_id\":\"67ca982ef38a654a7c2c1a60\",\"id\":\"67ca982ef38a654a7c2c1a64\",\"url\":\"/category-a-2\",\"path\":\"/category-a-2\"},{\"name\":\"Subcategory 3\",\"slug\":\"category-a-3\",\"image\":\"\",\"parent_id\":\"67ca982ef38a654a7c2c1a60\",\"id\":\"67ca982ef38a654a7c2c1a65\",\"url\":\"/category-a-3\",\"path\":\"/category-a-3\"}],\"products\":[],\"productsTotalCount\":0,\"productsHasMore\":false,\"productsMinPrice\":0,\"productsMaxPrice\":0,\"productsAttributes\":[],\"paymentMethods\":[],\"shippingMethods\":[],\"loadingProducts\":false,\"loadingMoreProducts\":false,\"loadingShippingMethods\":false,\"loadingPaymentMethods\":false,\"processingCheckout\":false,\"productFilter\":{\"onSale\":null,\"search\":\"\",\"categoryId\":\"67ca982ef38a654a7c2c1a63\",\"priceFrom\":0,\"priceTo\":0,\"attributes\":{},\"sort\":\"stock_status,price,position\",\"fields\":\"path,id,name,category_id,category_name,sku,images,enabled,discontinued,stock_status,stock_quantity,price,on_sale,regular_price,attributes,tags,position\",\"limit\":30},\"cart\":null,\"order\":null,\"checkoutFields\":[],\"themeSettings\":{\"checkoutInputClass\":\"checkout-field\",\"checkoutButtonClass\":\"checkout-button button is-primary\",\"checkoutEditButtonClass\":\"checkout-button button\",\"cartThumbnailWidth\":100,\"footer_contacts\":[{\"text\":\"104 N Stagecoach Rd\"},{\"text\":\"Dover Foxcroft, ME, 04426\"},{\"text\":\"(207) 564-8482\"},{\"text\":\"sales@shop.com\"}],\"footer_about\":\"Store - just to show you what it can. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here. Some text go here.\",\"footer_menu_2_title\":\"Customer service\",\"footer_menu_1_title\":\"Company\",\"footer_social\":[{\"type\":\"facebook\",\"url\":\"https://www.facebook.com/\"},{\"type\":\"twitter\",\"url\":\"https://twitter.com/\"}],\"footer_menu_1_items\":[{\"text\":\"About\",\"url\":\"/about\"},{\"text\":\"Blog\",\"url\":\"/blog\"},{\"text\":\"Terms of Service\",\"url\":\"/tos\"},{\"text\":\"Privacy Policy\",\"url\":\"/privacy-policy\"}],\"footer_menu_2_items\":[{\"text\":\"Shipping & returns\",\"url\":\"/\"},{\"text\":\"Conditions of Use\",\"url\":\"/\"},{\"text\":\"Sitemap\",\"url\":\"/\"}],\"search_placeholder\":\"\",\"home_products_limit\":8,\"home_products_title\":\"BEST SELLERS\",\"home_products_sort\":\"-date_updated\",\"home_slider\":[{\"path\":\"/page-1\",\"image\":\"slide8.jpg\",\"description\":\"COMFORT. SPORT. STYLE.\",\"title\":\"THE FRESH FOAM CRUZ\"},{\"path\":\"/page-2\",\"image\":\"slide9.jpg\"},{\"image\":\"slide7.jpg\",\"path\":\"/page-3\"}],\"home_slider_color\":\"#ffffff\",\"button_addtocart_text\":\"\",\"disqus_shortname\":\"cezerin\",\"maxCartItemQty\":100,\"product_thumbnail_position\":\"left\",\"bigThumbnailWidth\":800,\"previewThumbnailWidth\":100,\"list_image_max_height\":280,\"listThumbnailWidth\":340,\"show_product_filter\":true,\"show_category_breadcrumbs\":true,\"show_discount_countdown\":true,\"show_product_breadcrumbs\":true,\"sortNewest\":\"-date_created\",\"sortPriceLow\":\"price\",\"sortPriceHigh\":\"-price\",\"footer_logo_url\":\"logo.png\",\"limit_viewed_products\":4,\"show_viewed_products\":true,\"product_gallery_shownav\":true,\"page_list_tag\":\"blog\"}},\"form\":{}};\n  </script>\n\n  \n<script type=\"text/javascript\" src=\"/assets/js/theme-ec8cc0816c07de142d06.js\"></script><script type=\"text/javascript\" src=\"/assets/js/app-fa7b1039b702c699c76c.js\"></script><script type=\"text/javascript\" src=\"/assets/js/theme-ec8cc0816c07de142d06.js\"></script><script type=\"text/javascript\" src=\"/assets/js/app-fa7b1039b702c699c76c.js\"></script><script type=\"text/javascript\" src=\"/assets/js/theme-ec8cc0816c07de142d06.js\"></script><script type=\"text/javascript\" src=\"/assets/js/app-fa7b1039b702c699c76c.js\"></script>\n\n</body></html>"
}

if __name__ == "__main__":
    unittest.main()